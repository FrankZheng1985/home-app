<!--pages/family/family.wxml - 3Dæç®€ç§‘æŠ€ç‰ˆ-->
<view class="page-container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="hero-section">
    <view class="hero-bg-glow"></view>
    <view class="hero-content page-fade-in">
      <view class="hero-title">å®¶åº­ç®¡ç†</view>
      <view class="hero-subtitle">Family Management</view>
    </view>
  </view>

  <!-- å®¶åº­ä¿¡æ¯å¡ç‰‡ (Glassmorphism Card) -->
  <view class="glass-card family-card success-pop" wx:if="{{familyInfo}}">
    <view class="family-main">
      <view class="family-icon">ğŸ </view>
      <view class="family-info">
        <text class="family-name">{{familyInfo.name}}</text>
        <text class="family-members-count">{{members.length}} ä½æˆå‘˜</text>
      </view>
    </view>
    
    <view class="quick-actions-grid">
      <view class="quick-action" bindtap="showInvite">
        <view class="action-icon">ğŸ“¨</view>
        <text class="action-text">é‚€è¯·</text>
      </view>
      <view class="quick-action" bindtap="showEditName" wx:if="{{isAdmin}}">
        <view class="action-icon">âœï¸</view>
        <text class="action-text">æ›´å</text>
      </view>
      <view class="quick-action" bindtap="showFamilyCode">
        <view class="action-icon">ğŸ“‹</view>
        <text class="action-text">é‚€è¯·ç </text>
      </view>
      <view class="quick-action" bindtap="showRoleManager" wx:if="{{isCreator}}">
        <view class="action-icon">ğŸ‘¥</view>
        <text class="action-text">æƒé™</text>
      </view>
    </view>
  </view>

  <!-- æˆå‘˜åˆ—è¡¨ -->
  <view class="section-title">å®¶åº­æˆå‘˜</view>
  <view class="members-list">
    <view class="member-item glass-card" wx:for="{{members}}" wx:key="id">
      <image class="member-avatar" src="{{item.user.avatarUrl || '/assets/images/default-avatar.png'}}" mode="aspectFill" />
      <view class="member-info">
        <view class="name-row">
          <text class="member-name">{{item.user.nickname}}</text>
          <view class="role-badge {{item.role}}">{{item.role === 'creator' ? 'åˆ›å»ºè€…' : item.role === 'admin' ? 'ç®¡ç†å‘˜' : 'æˆå‘˜'}}</view>
        </view>
        <view class="member-points">
          <text class="points-value">{{item.totalPoints || 0}}</text>
          <text class="points-label">ç§¯åˆ†</text>
        </view>
      </view>
      <view class="member-action" 
            wx:if="{{isAdmin && item.userId !== currentUserId && item.role !== 'creator'}}"
            catchtap="showMemberActions" data-member-id="{{item.id}}" data-member-name="{{item.user.nickname}}">
        <text>â‹¯</text>
      </view>
    </view>
  </view>

  <!-- å±é™©åŒºåŸŸ -->
  <view class="danger-zone" wx:if="{{familyInfo}}">
    <view class="logout-btn" bindtap="leaveFamily">é€€å‡ºå®¶åº­</view>
  </view>

  <view class="safe-bottom"></view>
</view>
