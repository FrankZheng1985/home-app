<!--pages/profile/profile.wxml - 3D极简科技版-->
<view class="page-container profile-page">
  <!-- 头部区域 -->
  <view class="profile-header">
    <view class="header-bg-glow"></view>
    <view class="header-content page-fade-in">
      <view class="user-section" bindtap="{{isLoggedIn ? 'goToEdit' : 'goToLogin'}}">
        <view class="avatar-wrapper">
          <image 
            class="user-avatar" 
            src="{{isLoggedIn ? (userInfo.avatarUrl || '/assets/images/default-avatar.png') : '/assets/images/default-avatar.png'}}"
            mode="aspectFill"
          ></image>
          <view class="avatar-ring"></view>
        </view>
        <view class="user-info">
          <text class="user-name">{{isLoggedIn ? (userInfo.nickname || '设置昵称') : '点击登录'}}</text>
          <view class="user-family">
            <text class="family-icon">🏠</text>
            <text class="family-name">{{isLoggedIn ? (familyInfo.name || '暂未加入家庭') : '开启智能家庭生活'}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 核心数据卡片 (仅登录显示) -->
  <view class="glass-card stats-card success-pop" wx:if="{{isLoggedIn && familyInfo}}">
    <view class="stat-group">
      <view class="stat-item">
        <text class="stat-label">累计积分</text>
        <text class="stat-value">{{pointsSummary.totalPoints || 0}}</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-label">完成家务</text>
        <text class="stat-value">{{choreCount || 0}}</text>
      </view>
    </view>
  </view>

  <!-- 菜单列表 -->
  <view class="menu-list">
    <view class="glass-card menu-group">
      <view class="menu-item" bindtap="onMenuTap" data-url="/pages/profile/edit" wx:if="{{isLoggedIn}}">
        <view class="menu-icon">👤</view>
        <text class="menu-title">个人资料</text>
        <text class="menu-arrow">›</text>
      </view>
      <view class="menu-item" bindtap="onMenuTap" data-url="/pages/profile/preferences" wx:if="{{isLoggedIn}}">
        <view class="menu-icon">💝</view>
        <text class="menu-title">我的喜好</text>
        <text class="menu-arrow">›</text>
      </view>
      <view class="menu-item" bindtap="onMenuTap" data-url="/pages/profile/points" wx:if="{{isLoggedIn && familyInfo}}">
        <view class="menu-icon">💰</view>
        <text class="menu-title">积分明细</text>
        <text class="menu-arrow">›</text>
      </view>
      <view class="menu-item" bindtap="onMenuTap" data-url="/pages/workbench/workbench" wx:if="{{isLoggedIn && isAdmin}}">
        <view class="menu-icon">⚙️</view>
        <text class="menu-title">管理工作台</text>
        <text class="menu-arrow">›</text>
      </view>
    </view>

    <view class="glass-card menu-group">
      <view class="menu-item" bindtap="onMenuTap" data-url="/pages/profile/feedback">
        <view class="menu-icon">💬</view>
        <text class="menu-title">意见反馈</text>
        <text class="menu-arrow">›</text>
      </view>
      <view class="menu-item" bindtap="onMenuTap" data-url="/pages/profile/about">
        <view class="menu-icon">ℹ️</view>
        <text class="menu-title">关于我们</text>
        <text class="menu-arrow">›</text>
      </view>
    </view>

    <!-- 退出登录按钮 -->
    <view class="logout-section" wx:if="{{isLoggedIn}}">
      <view class="logout-btn" bindtap="logout">退出登录</view>
    </view>
  </view>

  <view class="version-info">家庭小助手 v1.0.0</view>
  
  <!-- 底部安全区域占位 -->
  <view class="safe-bottom"></view>
</view>